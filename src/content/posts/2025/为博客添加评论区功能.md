---
title: '为博客配置评论区'
published: 2025-08-13  # 注意这里改为 published 而不是 pubDate
description: '还支持亮色暗色模式切换'
author: 'mio'
tags: ["博客开发"]
category: 博客开发
updated: 2025-08-13
---

# 为博客配置评论区

1. 在 misc 目录下新建 Giscus.astro 文件，内容如下（用你自己的参数替换）：

```
<div id="giscus-comments"></div>

<script src="https://giscus.app/client.js"

  data-repo="17356085/17356085.github.io"

  data-repo-id="R_kgDOPcYMPg"

  data-category="Announcements"

  data-category-id="DIC_kwDOPcYMPs4CuH1t"

  data-mapping="pathname"

  data-strict="0"

  data-reactions-enabled="1"

  data-emit-metadata="0"

  data-input-position="bottom"

  data-theme="{theme}"

  data-lang="zh-CN"

  crossorigin="anonymous"

  async>

</script>

<script is:inline>
  // 你站点的暗色主题 class，通常是 'dark'
  const DARK_CLASS = 'dark';
  // giscus 支持的主题名
  const LIGHT_THEME = 'light';
  const DARK_THEME = 'dark';

  function setGiscusTheme(theme) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;
    iframe.contentWindow.postMessage(
      {
        giscus: {
          setConfig: {
            theme: theme,
          },
        },
      },
      'https://giscus.app'
    );
  }

  // 检查当前主题
  function getCurrentTheme() {
    return document.documentElement.classList.contains(DARK_CLASS) ? DARK_THEME : LIGHT_THEME;
  }

  // 初始设置
  window.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => setGiscusTheme(getCurrentTheme()), 500);
  });

  // 监听主题切换（假设你的主题切换会修改 <html> 的 class）
  const observer = new MutationObserver(() => {
    setGiscusTheme(getCurrentTheme());
  });
  observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });
</script>
```

2. 在 [...slug].astro 中这样导入和使用：

```
import Giscus from "../../components/misc/Giscus.astro";
// ...existing code...

<!-- 推荐插入在 License 之后、分页导航之前 -->
{licenseConfig.enable && <License ... />}
<Giscus />

<div class="flex flex-col md:flex-row justify-between mb-4 gap-4 overflow-hidden w-full">
  {/* ...分页导航... */}
</div>
```
