import{o as rt,e as lt,i as it,r as nt,s as C,c as vt,f as ct}from"./store.C1-XR_2L.js";import{aA as ot,a5 as ut,u as w,U as dt,am as ft,f as pt,t as gt,j as m,g as t,a as D,p as mt,d as h,b as ht,s as i,m as u,aB as F,c as d,r as f,e as W,aC as K}from"./utils.ChTzs6al.js";import{s as G}from"./render.BkyFzsZL.js";import{i as wt}from"./if.Dfyww8H0.js";import{b as _t}from"./input.BuNBMkz9.js";import{p as bt}from"./props.CE4ccg_C.js";/* empty css                        */function H(n,v){return n===v||n?.[ft]===v}function J(n={},v,s,e){return ot(()=>{var r,l;return ut(()=>{r=l,l=[],w(()=>{n!==s(...l)&&(v(n,...l),r&&H(s(...r),n)&&v(null,...r))})}),()=>{dt(()=>{l&&H(s(...l),n)&&v(null,...l)})}}),n}var xt=K('<svg viewBox="0 0 24 24" class="svelte-a168sw"><rect x="6" y="5" width="4" height="14" rx="1"></rect><rect x="14" y="5" width="4" height="14" rx="1"></rect></svg>'),yt=K('<svg viewBox="0 0 24 24" class="svelte-a168sw"><path d="M8 5v14l11-7z"></path></svg>'),kt=pt('<div class="player svelte-a168sw"><img/> <div class="info svelte-a168sw"><div class="title-container svelte-a168sw"><div class="title svelte-a168sw"> </div></div> <div class="time svelte-a168sw"> </div> <input type="range" min="0" step="0.01" class="progress svelte-a168sw"/></div> <div class="controls svelte-a168sw"><button aria-label="Last" class="ctrl svelte-a168sw"><svg viewBox="0 0 24 24" class="svelte-a168sw"><path d="M16 5v14l-11-7z"></path></svg></button> <button aria-label="Play/Pause" class="ctrl play-pause svelte-a168sw"><!></button> <button aria-label="Next" class="ctrl svelte-a168sw"><svg viewBox="0 0 24 24" class="svelte-a168sw"><path d="M8 5v14l11-7z"></path></svg></button></div></div>');function Pt(n,v){ht(v,!1);let s=bt(v,"audioList",24,()=>[]),e,r=u(0),l=u(!1),_=u(0),o=u(0),j,p=u(0),b=1,S=0,T,x=u(),y=u();function q(a){const c=Math.floor(a/60).toString().padStart(2,"0"),A=Math.floor(a%60).toString().padStart(2,"0");return`${c}:${A}`}function N(){e&&(t(l)?e.pause():e.play(),i(l,!t(l)))}function B(){const a=s()[t(r)];!a||!e||(e.src=a.src,e.play().then(()=>{i(l,!0)}),U())}function Q(){s().length!==0&&(i(r,(t(r)-1+s().length)%s().length),B())}function O(){s().length!==0&&(i(r,(t(r)+1)%s().length),B())}function R(a){e&&(e.currentTime=+a.target.value,i(o,e.currentTime))}rt(async()=>{e=new Audio,e.loop=!1,e.addEventListener("loadedmetadata",()=>{i(_,e.duration)}),e.addEventListener("timeupdate",()=>{i(o,e.currentTime)}),e.addEventListener("ended",()=>O()),B(),j=setInterval(()=>{e&&i(o,e.currentTime)},200),await F(),U()}),lt(()=>{clearInterval(j),clearInterval(T),e&&(e.pause(),e.src="",e=null)});async function U(){if(clearInterval(T),i(p,0),b=1,await F(),t(x)&&t(y)){const a=t(x).scrollWidth,c=t(y).clientWidth;S=a-c,S>0&&(T=setInterval(()=>{i(p,t(p)+b),(t(p)>=S||t(p)<=0)&&(b=-b)},100))}}it();var E=kt(),g=d(E);let X;var P=h(g,2),k=d(P),L=d(k),V=d(L,!0);f(L),J(L,a=>i(x,a),()=>t(x)),f(k),J(k,a=>i(y,a),()=>t(y));var z=h(k,2),Z=d(z);f(z);var I=h(z,2);nt(I),f(P);var Y=h(P,2),$=d(Y),M=h($,2),tt=d(M);{var at=a=>{var c=xt();D(a,c)},et=a=>{var c=yt();D(a,c)};wt(tt,a=>{t(l)?a(at):a(et,!1)})}f(M);var st=h(M,2);f(Y),f(E),gt((a,c,A)=>{C(g,"src",(W(s()),t(r),w(()=>s()[t(r)]?.cover))),C(g,"alt",(W(s()),t(r),w(()=>s()[t(r)]?.name))),X=vt(g,1,"cover svelte-a168sw",null,X,a),ct(L,`transform: translateX(-${t(p)??""}px);`),G(V,(W(s()),t(r),w(()=>s()[t(r)]?.name))),G(Z,`${c??""} / ${A??""}`),C(I,"max",t(_))},[()=>({spinning:t(l)}),()=>(t(o),w(()=>q(t(o)))),()=>(t(_),w(()=>q(t(_))))]),m("click",g,N),m("error",g,a=>{console.error("图片加载失败：",a.target.src)}),_t(I,()=>t(o),a=>i(o,a)),m("input",I,R),m("click",$,Q),m("click",M,N),m("click",st,O),D(n,E),mt()}export{Pt as default};
